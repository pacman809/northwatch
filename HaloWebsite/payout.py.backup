#!/usr/bin/env python3


import os
import pymongo
import time
import datetime
from web3 import Web3
from datetime import datetime



    
def timestamp(stamp):
		time = 			stamp
		dt = 			datetime.fromtimestamp(time // 1000000000)
		s = 			dt.strftime('%Y-%m-%d %H:%M:%S')
		return s


def payout():

		
		db 			= "halo-explorer-mainnet"
		myclient 	= pymongo.MongoClient("mongodb://localhost:27017/")
		mydb 		= myclient[db]
		myCol 		= mydb["transactions"]
		geth_url 	= "http://192.168.1.139:8545"
		list 		= []
		MN_Array 	= []

		web3 = Web3(Web3.HTTPProvider(geth_url))
		

		for x in myCol.find({"to_address": "0xc660934ec084698e373ac844ce29cf27b104f696"}).limit(1000):#.sort('block_number', pymongo.DESCENDING):
			bob = x["input"]
			bob = str(bob[0:10])
			#print(bob)
			if bob == "0xdf6c39fb":
				list.append(x["block_timestamp"])
				payout = list[-1]
				payout = timestamp(payout)

		return payout

